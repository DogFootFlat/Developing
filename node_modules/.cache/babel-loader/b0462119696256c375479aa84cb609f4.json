{"ast":null,"code":"import _regeneratorRuntime from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _readOnlyError from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/readOnlyError.js\";import React,{useState,useEffect,useContext,useCallback}from\"react\";import{useNavigate}from\"react-router\";import{Link}from\"react-router-dom\";import ApiService from\"../../ApiService\";import AuthContext from\"../../store/auth-context\";import Card from\"../basic/Card\";import LoanFilter from\"./LoanFilter\";import LoanChart from\"./LoanChart\";import LoanList from\"./LoanList\";import Loading from\"../basic/Loading\";import{Typography}from\"@mui/material\";import loancountcss from\"./css/loancount.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LoanCount=function LoanCount(){var navigate=useNavigate();var ctx=useContext(AuthContext);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),books=_useState2[0],setBooks=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(\"all\"),_useState8=_slicedToArray(_useState7,2),filteredCategory=_useState8[0],setFilteredCategory=_useState8[1];var filterChangeHandler=function filterChangeHandler(selectedCategory){setFilteredCategory(selectedCategory);};var fetchBooksHandler=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);_context.prev=2;_context.next=5;return ApiService.fetchBooks();case 5:response=_context.sent;if(!(response.status<200||response.status>299)){_context.next=8;break;}throw new Error(\"Something went wrong!\");case 8:_context.next=10;return response.data;case 10:data=_context.sent;setBooks(data);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);setError(_context.t0.message);case 17:setIsLoading(false);case 18:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);})),[]);useEffect(function(){fetchBooksHandler();ctx.setCurrentPage(\"loan-count\");},[fetchBooksHandler]);var filteredBooks=books;if(filteredCategory!==\"all\"){books.filter(function(book){return book.category===filteredCategory;}),_readOnlyError(\"filteredBooks\");}var content=/*#__PURE__*/_jsx(\"h5\",{children:\"\\uD604\\uC7AC \\uB3C4\\uC11C \\uBAA9\\uB85D\\uC774 \\uBE44\\uC5B4\\uC788\\uC2B5\\uB2C8\\uB2E4.\"});if(books.length>0){content=/*#__PURE__*/_jsxs(Card,{className:loancountcss.chart,children:[/*#__PURE__*/_jsx(LoanFilter,{selected:filteredCategory,onChangeFilter:filterChangeHandler}),/*#__PURE__*/_jsx(LoanChart,{books:filteredBooks}),/*#__PURE__*/_jsx(LoanList,{items:filteredBooks})]});}if(error){content=/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:error})});}if(isLoading){content=/*#__PURE__*/_jsx(Loading,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(Typography,{className:loancountcss.typo,variant:\"h6\",children:\"\\uB3C4\\uC11C \\uB300\\uC5EC \\uD1B5\\uACC4\"})}),content]});};export default LoanCount;","map":{"version":3,"names":["React","useState","useEffect","useContext","useCallback","useNavigate","Link","ApiService","AuthContext","Card","LoanFilter","LoanChart","LoanList","Loading","Typography","loancountcss","LoanCount","navigate","ctx","books","setBooks","isLoading","setIsLoading","error","setError","filteredCategory","setFilteredCategory","filterChangeHandler","selectedCategory","fetchBooksHandler","fetchBooks","response","status","Error","data","message","setCurrentPage","filteredBooks","filter","book","category","content","length","chart","typo"],"sources":["C:/OtpishiAI/src/components/book/LoanCount.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext, useCallback } from \"react\";\r\nimport { useNavigate } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport ApiService from \"../../ApiService\";\r\nimport AuthContext from \"../../store/auth-context\";\r\nimport Card from \"../basic/Card\";\r\nimport LoanFilter from \"./LoanFilter\";\r\nimport LoanChart from \"./LoanChart\";\r\nimport LoanList from \"./LoanList\";\r\nimport Loading from \"../basic/Loading\";\r\nimport { Typography } from \"@mui/material\";\r\nimport loancountcss from \"./css/loancount.module.css\";\r\n\r\nconst LoanCount = () => {\r\n  const navigate = useNavigate();\r\n  const ctx = useContext(AuthContext);\r\n\r\n  const [books, setBooks] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [filteredCategory, setFilteredCategory] = useState(\"all\");\r\n  const filterChangeHandler = (selectedCategory) => {\r\n    setFilteredCategory(selectedCategory);\r\n  }\r\n\r\n  const fetchBooksHandler = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await ApiService.fetchBooks();\r\n      if (response.status < 200 || response.status > 299) {\r\n        throw new Error(\"Something went wrong!\");\r\n      }\r\n      const data = await response.data;\r\n      setBooks(data);\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n    setIsLoading(false);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchBooksHandler();\r\n    ctx.setCurrentPage(\"loan-count\");\r\n  }, [fetchBooksHandler]);\r\n\r\n  const filteredBooks = books;\r\n  if (filteredCategory !== \"all\") {\r\n    filteredBooks = books.filter((book) => {\r\n      return book.category === filteredCategory;\r\n    });\r\n  }\r\n\r\n  let content = <h5>현재 도서 목록이 비어있습니다.</h5>;\r\n  if (books.length > 0) {\r\n    content = (\r\n      <Card className={loancountcss.chart}>\r\n        <LoanFilter\r\n          selected={filteredCategory}\r\n          onChangeFilter={filterChangeHandler}\r\n        />\r\n        <LoanChart books={filteredBooks} />\r\n        <LoanList items={filteredBooks} />\r\n      </Card>\r\n    );\r\n  }\r\n  if (error) {\r\n    content = (\r\n      <div>\r\n        <p>{error}</p>\r\n      </div>\r\n    );\r\n  }\r\n  if (isLoading) {\r\n    content = <Loading />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <section>\r\n        <Typography className={loancountcss.typo} variant=\"h6\">\r\n          도서 대여 통계\r\n        </Typography>\r\n      </section>\r\n      {content}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LoanCount;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}