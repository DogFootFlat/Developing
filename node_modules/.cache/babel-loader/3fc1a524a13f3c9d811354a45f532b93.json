{"ast":null,"code":"import _regeneratorRuntime from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext,useCallback}from\"react\";import{useNavigate}from\"react-router\";import{Link}from\"react-router-dom\";import ApiService from\"../../ApiService\";import AuthContext from\"../../store/auth-context\";import Loading from\"../basic/Loading\";import{Table,TableBody,TableCell,TableHead,TableRow,Button,Typography}from\"@mui/material\";import CreateIcon from\"@material-ui/icons/Create\";import DeleteIcon from\"@material-ui/icons/Delete\";import userscss from\"./css/users.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UserList=function UserList(){var navigate=useNavigate();var ctx=useContext(AuthContext);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var fetchUsersHandler=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);_context.prev=2;_context.next=5;return ApiService.fetchUsers();case 5:response=_context.sent;if(!(response.status<200||response.status>299)){_context.next=8;break;}throw new Error(\"Something went wrong!\");case 8:_context.next=10;return response.data;case 10:data=_context.sent;setUsers(data);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);setError(_context.t0.message);case 17:setIsLoading(false);case 18:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);})),[]);useEffect(function(){fetchUsersHandler();ctx.setCurrentPage(\"users\");},[fetchUsersHandler]);var deleteUserHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(userID){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsLoading(true);setError(null);_context2.prev=2;_context2.next=5;return ApiService.deleteUser(userID);case 5:response=_context2.sent;if(!(response.status<200||response.status>299)){_context2.next=8;break;}throw new Error(\"Something went wrong!\");case 8:setUsers(users.filter(function(user){return user.id!==userID;}));_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](2);setError(_context2.t0.message);case 14:setIsLoading(false);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[2,11]]);}));return function deleteUserHandler(_x){return _ref2.apply(this,arguments);};}();var moveToEditUserHandler=function moveToEditUserHandler(userId){navigate(\"/edit-user\",{state:{id:userId}});};var content=/*#__PURE__*/_jsx(\"h5\",{children:\"\\uD604\\uC7AC \\uD68C\\uC6D0 \\uBAA9\\uB85D\\uC774 \\uBE44\\uC5B4\\uC788\\uC2B5\\uB2C8\\uB2E4.\"});if(users.length>0){content=/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{className:userscss.idCell,children:\"ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\uD68C\\uC6D0\\uBA85\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\uBE44\\uBC00\\uBC88\\uD638\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\uBE4C\\uB9B0 \\uCC45(1)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\uBE4C\\uB9B0 \\uCC45(2)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\uBE4C\\uB9B0 \\uCC45(3)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"\\uAE30\\uBD80\\uD55C \\uCC45\"}),/*#__PURE__*/_jsx(TableCell,{children:\"RFID\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"\\uD3B8\\uC9D1\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"\\uC0AD\\uC81C\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:users.map(function(user){return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{className:userscss.idCell,component:\"th\",scope:\"user\",children:user.id}),/*#__PURE__*/_jsx(TableCell,{children:user.name}),/*#__PURE__*/_jsx(TableCell,{children:user.pw}),/*#__PURE__*/_jsx(TableCell,{children:user.borrow1}),/*#__PURE__*/_jsx(TableCell,{children:user.borrow2}),/*#__PURE__*/_jsx(TableCell,{children:user.borrow3}),/*#__PURE__*/_jsx(TableCell,{children:user.donate}),/*#__PURE__*/_jsx(TableCell,{children:user.uid}),/*#__PURE__*/_jsx(TableCell,{className:userscss.iconCell,children:/*#__PURE__*/_jsx(CreateIcon,{className:userscss.hover,onClick:function onClick(){return moveToEditUserHandler(user.id);}})}),/*#__PURE__*/_jsx(TableCell,{className:userscss.iconCell,children:/*#__PURE__*/_jsx(DeleteIcon,{className:userscss.hover,onClick:function onClick(){return deleteUserHandler(user.id);}})})]},user.id);})})]});}if(error){content=/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:error})});}if(isLoading){content=/*#__PURE__*/_jsx(Loading,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{className:userscss.typo,variant:\"h6\",children:\"\\uBC84\\uD2BC\\uC744 \\uD074\\uB9AD\\uD558\\uC5EC \\uD68C\\uC6D0 \\uCD94\\uAC00\"}),/*#__PURE__*/_jsx(Button,{className:userscss.addBtn,variant:\"contained\",color:\"primary\",children:/*#__PURE__*/_jsxs(Link,{to:\"/add-user\",className:userscss.link,children:[\" \",\"\\uD68C\\uC6D0 \\uCD94\\uAC00\",\" \"]})}),content]});};export default UserList;","map":{"version":3,"names":["React","useState","useEffect","useContext","useCallback","useNavigate","Link","ApiService","AuthContext","Loading","Table","TableBody","TableCell","TableHead","TableRow","Button","Typography","CreateIcon","DeleteIcon","userscss","UserList","navigate","ctx","users","setUsers","error","setError","isLoading","setIsLoading","fetchUsersHandler","fetchUsers","response","status","Error","data","message","setCurrentPage","deleteUserHandler","userID","deleteUser","filter","user","id","moveToEditUserHandler","userId","state","content","length","idCell","map","name","pw","borrow1","borrow2","borrow3","donate","uid","iconCell","hover","typo","addBtn","link"],"sources":["C:/OtpishiAI/src/components/user/UserList.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext, useCallback } from \"react\";\r\nimport { useNavigate } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport ApiService from \"../../ApiService\";\r\nimport AuthContext from \"../../store/auth-context\";\r\nimport Loading from \"../basic/Loading\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableRow,\r\n  Button,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport CreateIcon from \"@material-ui/icons/Create\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport userscss from \"./css/users.module.css\";\r\n\r\nconst UserList = () => {\r\n  const navigate = useNavigate();\r\n  const ctx = useContext(AuthContext);\r\n\r\n  const [users, setUsers] = useState([]);\r\n  const [error, setError] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const fetchUsersHandler = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await ApiService.fetchUsers();\r\n      if (response.status < 200 || response.status > 299) {\r\n        throw new Error(\"Something went wrong!\");\r\n      }\r\n      const data = await response.data;\r\n      setUsers(data);\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n    setIsLoading(false);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchUsersHandler();\r\n    ctx.setCurrentPage(\"users\");\r\n  }, [fetchUsersHandler]);\r\n\r\n  const deleteUserHandler = async (userID) => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await ApiService.deleteUser(userID);\r\n      if (response.status < 200 || response.status > 299) {\r\n        throw new Error(\"Something went wrong!\");\r\n      }\r\n      setUsers(users.filter((user) => user.id !== userID));\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n    setIsLoading(false);\r\n  };\r\n\r\n  const moveToEditUserHandler = (userId) => {\r\n    navigate(\"/edit-user\", {\r\n      state: {\r\n        id: userId,\r\n      },\r\n    });\r\n  };\r\n\r\n  let content = <h5>현재 회원 목록이 비어있습니다.</h5>;\r\n  if (users.length > 0) {\r\n    content = (\r\n      <Table>\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell className={userscss.idCell}>ID</TableCell>\r\n            <TableCell>회원명</TableCell>\r\n            <TableCell>비밀번호</TableCell>\r\n            <TableCell>빌린 책(1)</TableCell>\r\n            <TableCell>빌린 책(2)</TableCell>\r\n            <TableCell>빌린 책(3)</TableCell>\r\n            <TableCell>기부한 책</TableCell>\r\n            <TableCell>RFID</TableCell>\r\n            <TableCell align=\"center\">편집</TableCell>\r\n            <TableCell align=\"center\">삭제</TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {users.map((user) => (\r\n            <TableRow key={user.id}>\r\n              <TableCell\r\n                className={userscss.idCell}\r\n                component=\"th\"\r\n                scope=\"user\"\r\n              >\r\n                {user.id}\r\n              </TableCell>\r\n              <TableCell>{user.name}</TableCell>\r\n              <TableCell>{user.pw}</TableCell>\r\n              <TableCell>{user.borrow1}</TableCell>\r\n              <TableCell>{user.borrow2}</TableCell>\r\n              <TableCell>{user.borrow3}</TableCell>\r\n              <TableCell>{user.donate}</TableCell>\r\n              <TableCell>{user.uid}</TableCell>\r\n              <TableCell className={userscss.iconCell}>\r\n                <CreateIcon\r\n                  className={userscss.hover}\r\n                  onClick={() => moveToEditUserHandler(user.id)}\r\n                />\r\n              </TableCell>\r\n              <TableCell className={userscss.iconCell}>\r\n                <DeleteIcon\r\n                  className={userscss.hover}\r\n                  onClick={() => deleteUserHandler(user.id)}\r\n                />\r\n              </TableCell>\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    );\r\n  }\r\n  if (error) {\r\n    content = (\r\n      <div>\r\n        <p>{error}</p>\r\n      </div>\r\n    );\r\n  }\r\n  if (isLoading) {\r\n    content = <Loading />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Typography className={userscss.typo} variant=\"h6\">\r\n        버튼을 클릭하여 회원 추가\r\n      </Typography>\r\n      <Button className={userscss.addBtn} variant=\"contained\" color=\"primary\">\r\n        <Link to={\"/add-user\"} className={userscss.link}>\r\n          {\" \"}\r\n          회원 추가{\" \"}\r\n        </Link>\r\n      </Button>\r\n      {content}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default UserList;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}