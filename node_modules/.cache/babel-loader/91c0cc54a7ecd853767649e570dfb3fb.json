{"ast":null,"code":"import _regeneratorRuntime from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/OtpishiAI/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useCallback,useContext,useEffect,useState}from'react';import ApiService from'../../../ApiService';import AuthContext from'../../../store/auth-context';import Loading from'../../basic/Loading';import Card from'../UI/Card';import classes from'./css/AvailableProducts.module.css';import ProductForm from'./productForm/ProductForm';import ProductItem from'./productItem/ProductItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AvailableProducts=function AvailableProducts(){var ctx=useContext(AuthContext);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var fetchProductsHandler=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(queryString){var _response$data,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);_context.prev=2;response={};if(!(queryString&&queryString!==''&&queryString!=='all')){_context.next=10;break;}_context.next=7;return ApiService.fetchPrudctsByQueryString(queryString);case 7:response=_context.sent;_context.next=13;break;case 10:_context.next=12;return ApiService.fetchProducts();case 12:response=_context.sent;case 13:if(!(response.status<200||response.status>299)){_context.next=15;break;}throw new Error('Something went wrong!');case 15:_context.next=17;return(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.content;case 17:data=_context.sent;setProducts(data);_context.next=24;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](2);setError(_context.t0.message);case 24:setIsLoading(false);case 25:case\"end\":return _context.stop();}}},_callee,null,[[2,21]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);useEffect(function(){fetchProductsHandler();ctx.setCurrentPage('prod-list');},[fetchProductsHandler]);if(products.length<=0){return/*#__PURE__*/_jsx(Card,{className:classes.products,children:/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD604\\uC7AC \\uC0C1\\uD488 \\uBAA9\\uB85D\\uC774 \\uBE44\\uC5B4\\uC788\\uC2B5\\uB2C8\\uB2E4.\"})});}if(error){return/*#__PURE__*/_jsx(Card,{className:classes.products,children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:error})})});}if(isLoading){return/*#__PURE__*/_jsxs(Card,{className:classes.products,children:[/*#__PURE__*/_jsx(Loading,{}),\";\"]});}var productsList=products.map(function(product){return/*#__PURE__*/_jsx(ProductItem,{id:product.productCode,name:product.productName,genre:product.genreCode,img:product.productImg[0],price:product.oprice},product.productCode);});return/*#__PURE__*/_jsxs(Card,{className:classes.products,children:[/*#__PURE__*/_jsx(ProductForm,{props:{fetchProductsHandler:fetchProductsHandler}}),/*#__PURE__*/_jsx(\"ul\",{children:productsList})]});};export default AvailableProducts;","map":{"version":3,"names":["React","useCallback","useContext","useEffect","useState","ApiService","AuthContext","Loading","Card","classes","ProductForm","ProductItem","AvailableProducts","ctx","products","setProducts","isLoading","setIsLoading","error","setError","fetchProductsHandler","queryString","response","fetchPrudctsByQueryString","fetchProducts","status","Error","data","content","message","setCurrentPage","length","productsList","map","product","productCode","productName","genreCode","productImg","oprice"],"sources":["C:/OtpishiAI/src/components/product/products/AvailableProducts.js"],"sourcesContent":["import React, { useCallback, useContext, useEffect, useState } from 'react';\r\nimport ApiService from '../../../ApiService';\r\nimport AuthContext from '../../../store/auth-context';\r\nimport Loading from '../../basic/Loading';\r\nimport Card from '../UI/Card';\r\nimport classes from './css/AvailableProducts.module.css';\r\nimport ProductForm from './productForm/ProductForm';\r\nimport ProductItem from './productItem/ProductItem';\r\n\r\nconst AvailableProducts = () => {\r\n\tconst ctx = useContext(AuthContext);\r\n\r\n\tconst [products, setProducts] = useState([]);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [error, setError] = useState(null);\r\n\r\n\tconst fetchProductsHandler = useCallback(async (queryString) => {\r\n\t\tsetIsLoading(true);\r\n\t\tsetError(null);\r\n\t\ttry {\r\n\t\t\tlet response = {};\r\n\t\t\tif (queryString && queryString !== '' && queryString !== 'all') {\r\n\t\t\t\tresponse = await ApiService.fetchPrudctsByQueryString(queryString);\r\n\t\t\t} else {\r\n\t\t\t\tresponse = await ApiService.fetchProducts();\r\n\t\t\t}\r\n\t\t\tif (response.status < 200 || response.status > 299) {\r\n\t\t\t\tthrow new Error('Something went wrong!');\r\n\t\t\t}\r\n\t\t\tconst data = await response.data?.content;\r\n\t\t\tsetProducts(data);\r\n\t\t} catch (error) {\r\n\t\t\tsetError(error.message);\r\n\t\t}\r\n\t\tsetIsLoading(false);\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tfetchProductsHandler();\r\n\t\tctx.setCurrentPage('prod-list');\r\n\t}, [fetchProductsHandler]);\r\n\r\n\tif (products.length <= 0) {\r\n\t\treturn (\r\n\t\t\t<Card className={classes.products}>\r\n\t\t\t\t<h2>현재 상품 목록이 비어있습니다.</h2>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n\r\n\tif (error) {\r\n\t\treturn (\r\n\t\t\t<Card className={classes.products}>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<p>{error}</p>\r\n\t\t\t\t</div>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n\tif (isLoading) {\r\n\t\treturn (\r\n\t\t\t<Card className={classes.products}>\r\n\t\t\t\t<Loading />;\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n\r\n\tconst productsList = products.map((product) => (\r\n\t\t<ProductItem\r\n\t\t\tid={product.productCode}\r\n\t\t\tkey={product.productCode}\r\n\t\t\tname={product.productName}\r\n\t\t\tgenre={product.genreCode}\r\n\t\t\timg={product.productImg[0]}\r\n\t\t\tprice={product.oprice}\r\n\t\t/>\r\n\t));\r\n\r\n\treturn (\r\n\t\t<Card className={classes.products}>\r\n\t\t\t<ProductForm props={{ fetchProductsHandler }} />\r\n\t\t\t<ul>{productsList}</ul>\r\n\t\t</Card>\r\n\t);\r\n};\r\n\r\nexport default AvailableProducts;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}